---
title: Инженерия и эволюция
---

Как соотносятся инженерия и эволюция? Технический
прогресс/техноэволюция, которая делается инженерами --- это просто часть
эволюции? Или это не эволюция, а просто инженерия, «практика
агентов-людей с приданными им компьютерами»? Как об этом думать?
Участвуют ли инженеры в эволюции, или они и есть эволюция, или эволюция
сама по себе, а инженеры творят сами по себе, вне эволюции?

Думать об этом нужно как об эволюции через интеллект (evolution through
intelligence). Инженеры реализуют эволюционный алгоритм, но в этом
алгоритме есть оптимизации, связанные с использованием интеллекта как
общего мастерства решения самых разных проблем, которые не встречались
раньше, подробней это раскрывается в курсе «Образование для
образованных»^[<https://system-school.ru/uptodate>].

Как описывалось в курсе «Системное мышление», во вселенной действует
эволюционный физический процесс, который можно представить как (вполне
деятельное, то есть физичное) оптимизационное вычисление,
биологическая/дарвиновская эволюция тут часть этого общего эволюционного
физического процесса. Алгоритм эволюции как оптимизационного вычисления
кратко для случая биологии выражается в центральной догме молекулярной
биологии^[Помним, что вся литература и более подробное
изложение есть в «Системном мышлении».]: в ходе эволюции
обязательно появляется медиа с возможностью цифровой записи информации
репликаторов. Цифровая запись гарантирует точную многократную репликацию
без накопления ошибки (в случае аналоговой записи ошибки накапливаются,
точная репликация становится невозможной).

На цифровом носителе в ходе эволюции записываются программы генотипа
(речь на Земле идёт о ДНК и отчасти РНК, которые хранят информацию в
цифровой форме), затем эта цифровая информация разворачивается в уже
аналоговый фенотип, и далее она проходит от генов через проявления в
фенотипе на уровень популяции --- в том числе разделение на два пола,
стайный образ жизни, особенности воспитания детей, поведения по
терраформированию (например, строительство плотин бобрами) и т.д.

Это (от генотипа к фенотипу и далее, включая популяционные уровни и даже
социальную эволюцию, включая техноэволюцию) прямой ход накапливающегося
в ходе эволюции оптимизационного знания, приводящего к меньшему влиянию
сюрпризов окружающей среды на агентов/IPU. А вот назад в гены полученный
в ходе жизни организмов и популяций опыт идёт совсем другим способом,
симметрия тут нарушена: в гены удачные модификации попадают только в
ходе мутаций, и если они хороши, то репликация оригинала с мутацией
дальше происходит, а если не очень хороши, то не происходит, ибо фенотип
(вместе с его популяцией, если она оказалась недостаточно разнообразна в
части мутаций) вымирает.

Какие цели эволюции, что она оптимизирует? Она реализует физический
принцип минимального действия, который в данном случае трактуется как
информационный: минимизация свободной энергии, что можно перефразировать
как минимизация неприятного сюрприза, который агент/IPU получит от
окружающей среды. То есть эволюция борется с энтропией, которая рано или
поздно присылает какое-то существенное изменение внешних условий.
Достаточно подумать о более длительных масштабах, нежели «догнали и
съели» или «умер от голода»: удары астероида, взрывы сверхновых и т.д.
Не вопрос, будет ли катастрофа. Вопрос в том, когда будет, и насколько
удастся жизни проэволюционировать к этому моменту, чтобы не исчезнуть.
Пока достижений эволюции хватило примерно на 3.5 миллиарда лет
репликации механизмов, похожих на клетки, но репликация людей пошла уже
немного по-другому: они получились очень устойчивыми, и хорошо
размножились. Население Земли сегодня составляет порядка 8 миллиардов
человек^[<https://countrymeters.info/ru/World>].
Курс «Системное мышление» начинается как раз с того, что сравнивает
массу всех людей с биомассой всех остальных видов, а также оценки массы
преобразованной «неживой» части земли (автор тут задумчиво смотрит в
окно и оценивает массу домов, домашней утвари, дорожных покрытий,
производств, еды и отходов в радиусе 100 км вокруг себя, а живёт он в
центре Москвы).

Эволюция усложняет и усложняет реплицирующихся (то есть «создающих копии
себя») агентов/IPU как «создателей», чтобы эти репликаторы были более и
более устойчивы к воздействиям окружающей среды, чтобы были способны ко
всё более длительному выживанию во всегда в конечном итоге враждебной
среде. Муравейник потыкать палкой --- он за ночь восстанавливается, но и
если город потыкать какой-нибудь огромной палкой (печальные прецеденты с
атомными бомбами, да и просто тысячами тонн взрывчатки были), то город
тоже восстанавливается, причём масштабы этого «потыкать» несопоставимы.
Город восстанавливается во много бо́льших масштабах, и речь идёт именно о
количественных характеристиках: масса, энергия и скорость (учёт массы,
преобразуемой за какую-то единицу времени).

Итак, эволюционный процесс имеет целью получить устойчивый репликатор
(минимизация свободной энергии сводится тут к минимизации байесовского
сюрприза от внешней среды --- это и есть цель эволюции), который
копируется и копируется, выживая всё круче и круче на всё новых и новых
уровнях квазиустойчивости. При этом устойчивость к внешним воздействиям
и адаптивность резко повышается время от времени за счёт роста сложности
в больших эволюционных сдвигах: многоклеточные организмы, популяции,
паразитизм и симбиотика (когда паразит и хозяин вдруг находят взаимную,
а не одностороннюю выгоду. Когда-то наши митохондрии были паразитами в
клетках).

Между системными уровнями есть конфликты, квазиоптимальных
оптимизационных/архитектурных решений на предмет минимизации негативных
сюрпризов от проявления этих конфликтов много и от этого возникает
неустроенность (буйство самых разных видов, которые примерно одинаково
выживают, это относится и к буйству моделей автомобилей, телефонов и
т.д. --- характеристики их выживаемости в природе или на рынке примерно
равны, равно как и страны с постоянно меняющимися границами имеют
более-менее одинаковые условия для жизни, они существенно отличаются
только в деталях, сравнивать нужно тут просто с достаточно далёкими
моментами в истории, например со средневековьем или даже с каменным
веком, разница сегодняшнего дня в части устойчивости к массовому
вымиранию людей будет хорошо видна).

Иногда в ходе эволюции возникают существенные оптимизации, типа тех
самых переходов от одноклеточных к многоклеточным, или появление хорошей
цифровой памяти типа мозга с ручкой-бумажкой, или на следующем этапе
типа компьютеров с интернетом. Мы просто продолжаем пересказывать идеи
работ Ванчурина-Кацнельсона-Вольфа-Кунина, опять отсылаем для более
обстоятельного рассказа об эволюции к «Прикладному системному мышлению»,
подробности тут приводить не будем.

Эволюционный алгоритм можно ускорить через моделирование, то есть
реплицировать только важное, а потом фенотип (включая популяции!)
заставлять в самых важных аспектах проживать свою жизнь, доказывая свою
живучесть, в компьютере/виртуальном мире, достаточно большом мире, чтобы
вмещать популяции и моделировать более-менее точно эффекты от
взаимодействия популяций с окружающей их богатой средой, возможно
содержащей и другие популяции. Если иметь достаточные вычислительные
мощности, то делать это можно быстрее, чем проживать популяциям полную
жизнь в реальном мире. Можно считать это «ускоренным воспроизведением»,
да ещё и параллельно можно пробовать множество разных вариантов, но
опять же, если хватает вычислительных мощностей. Эволюция крайне
затратна в вычислениях!

Переход к «проживанию модели в компьютере» это вроде как уже инженерная
работа, «применение вычислителей для генерации догадок о полезных
мутациях, а потом фильтрации догадок об удачных мутациях». Инженерия тут
в том, что физически создаётся вычислитель виртуального мира, а в нём
создаются процессы «проживания» для моделей агентов/IPU (включая
популяции!) с потенциально интересными мутациями. Это отличный способ
ускорить прогресс, но у него есть существенные ограничения: требуются
немыслимо большие вычислительные мощности на моделирование N миров, в
которых живут и размножаются организмы и популяции, на которых мы
пробуем те или иные мутации. С этим боремся так: уменьшаем объём
моделирования (скажем, пытаемся вычислить только догадку о мутации, но
не моделируем выживание), увеличиваем доступную компьютерную мощь,
увеличиваем эффективность эволюционного алгоритма в целом (качество
генерирования догадок, точность моделирования и т.д.).

Например, в статье Evolution through Large
Models^[<https://arxiv.org/abs/2206.08896>],
предлагается использовать внутри эволюционного алгоритма вместо
случайных мутаций «умные», то есть «разработанные/вычисленные», а вместо
человека-инженера, высказывающего догадки о полезных мутациях,
использовать нейронную сетку большой языковой модели (модели языка и
мира, выученной нейронной сеткой определённой архитектуры).

Основная проблема в инженерии путём генерации новых архитектур
нейронными сетями в том, что архитектура должна давать вариант
многоуровневой оптимизации конфликтов между системными уровнями, при
этом нейросеть обычно не может сгенерировать оптимизацию, которая
выходит за рамки тех примеров, которые ей показывали в ходе обучения. А
эволюционный алгоритм принципиально может. Поэтому статья предлагает
оставить снаружи эволюционный алгоритм, принципиально дающий новизну
решений за пределами того, что уже видела нейронная сеть, но вставляем
внутрь «умный мутационный оператор» на основе нейросети, который
предлагает потенциально не смертельную мутацию. Помним, что в работах по
эволюции как многоуровневой оптимизации подчёркивалось, что всё в ходе
эволюции давно уже квазиоптимизировано, какие-то локальные оптимумы для
минимума свободной энергии целевой системы достигнуты, поэтому
большинство случайных мутаций будут смертельными (выходим за рамки
локального оптимума в менее благоприятные зоны), немного их будут
нейтральными (находим другой квазиоптимум, они очень близки обычно),
редко что-то приводит к маленькому улучшению текущего локального
оптимума, и совсем уж редко что-то радикально приближает к обычно
недостижимому глобальному оптимуму.

Если в основу эволюции брать не проверки по большому объёму
бессмысленных смертельных мутаций, а проверки по менее большому объёму
заведомо более осмысленных предложений, эволюция в целом пойдёт быстрее.
Статья демонстрирует это на примере эволюционного алгоритма для
генерации программного кода, порождаемого нейросетью ровно как это
делают системы подсказок для кода программ: GitHub Copilot и Amazon
CodeWhisperer. Если грубо, то статья предлагает вместо случайных
перестановок текста в генетических алгоритмах использовать подсказки
всех этих Copilots и
CodeWhisperers^[<https://techcrunch.com/2022/06/23/amazon-launches-codewhisperer-its-ai-pair-programming-tool/>].
И там же даётся ещё много разных других способов ускорить эволюцию (ибо
много ещё мест, где «универсальный аппроксиматор/оптимизатор» типа
нейронной сетки можно задействовать в эволюционном алгоритме).

Если представить, что у всех инженеров в голове есть вычислители этих
самых «умных мутаций» и других оптимизационных вставок в эволюционный
алгоритм, да ещё в последнее время эти «вычислители в голове» умощняются
компьютерами и средствами компьютерной связи для объединения вычислений
многих людей и компьютеров, то мы смело можем считать инженеров всей
Земли ускорителями эволюции. Мы берём инженеров вместе с их моделерами и
заводами: моделеры документируют мутации, а заводы производят какие-то
продукты, которые потом «пробуются жизнью на соответствие среде»,
некоторые из них оказываются удачны настолько, что предложенные в них
«мутации» оказываются достойными повторения. А поскольку в нашем подходе
инженеры --- это те, кто что-то делают/практикуются/трудятся, то всё
человечество оказывается мощным вычислителем-ускорителем эволюции, то
есть работает на то, чтобы минимизировать негативные сюрпризы от
окружающей среды, это и есть «изменение жизни к лучшему». Сложность
окружающего мира продолжает расти, но уже не только за счёт классической
биологической эволюции, но и за счёт технологической эволюции, которую
производят люди, и которая просто часть общей «физической» эволюции.

Итак, если инженеры угадали техническое решение, то «бинго, вымри твой
вид продукта сегодня, а мой вид завтра». Если не угадали, то будет
наоборот: финансирование работ тех, кто не угадал, будет прекращено. В
эволюции биологической вид вымирает, и эта неудачная ветвь просто
прекращает существование. В технологической эволюции ничего страшного не
происходит: все люди и их компьютеры обычно остаются живыми и просто
производят следующий вариант «умной мутации техносреды», пробуют что-то
ещё.

Так что для уменьшения бизнес-неудач остаётся поднять вероятность
угадывания хороших концептуальных (найти аффорданс/affordance: как
какую-то функцию реализовать каким-то объектом из окружения, решения по
концепции использования и концепции системы) и архитектурных решений
(способ разбиения конструктивных объектов на части-модули и организация
взаимодействия их такие, что архитектурные характеристики становятся
«наименее плохие из возможных») как «умных мутаций», и это ровно то, что
должны бы делать нейросетки: 1. Для языковых моделей типа T5 или GPT-3
поднимать степень осмысленности того, что они выдают в ответ на какие-то
промпты/prompt^[<https://en.wikipedia.org/wiki/Prompt_engineering>],
то есть улучшать и нейросети и способы генерирования промптов как
запросов к нейросети на продолжение промпта (принцип работы моделей типа
T5: они просто продолжают какую-то строку-промпт, например промпт «2x2=»
наверняка получит своим продолжением «4») и 2. учитывать для генерации
«не совсем случайной мутации» максимум информации о мире. Ровно это и
происходит: большие модели, выдающие эти самые мутации, могут
использовать знание о мире, которое воплощено не только в инженерных
кодах, компьютерных программах или информационных моделях (корпусная
инженерия^[<https://ailev.livejournal.com/1009201.html>]),
но и в просто текстах на естественном языке, а также фотографиях и
других изображениях^[Например, вот такие работы по
мультимодальным вычислениям в нейронных сетях --- Allen AI & UW Propose
Unified-IO: A High-Performance, Task-Agnostic Model for CV, NLP, and
Multi-Modal Tasks, <https://arxiv.org/abs/2206.08916>] и
даже геноме человека^[GENA\_LM --- первая в мире
языковая модель ДНК, обученная на самой полной версии генома человека
(T2T-CHM13), которая была опубликована в конце марта 2022 года,
<https://huggingface.co/AIRI-Institute/gena-lm-bert-base/>,
<https://github.com/AIRI-Institute/GENA_LM>], 3. Не
останавливаться в своих попытках на первой же, а продолжать (непрерывная
инженерия), пока позволяют ресурсы.

Дальше можно думать о том, чтобы запускать алгоритмы «умной мутации», то
есть алгоритмы архитектурных решений для того, чтобы улучшать и
эволюционные алгоритмы, и для того, чтобы улучшать мутационный оператор,
и для того, чтобы улучшать моделирование мира для определения того,
выживет ли индивид с фенотипом, определяемым мутацией в генотипе, в
виртуальном мире, чтобы уменьшить время экспериментирования и ресурсы,
требуемые для проверки выживаемости в физическом мире. Тут есть и
альтернативные подходы, которые прямо говорят о генерации каких-то
оптимальных архитектурных технических решений, без связи этого с идеями
эволюции (то есть рассматривается один жизненный цикл, а не то, что
параллельно идёт конкуренция с другими проектами, которые предлагают
другие варианты архитектурных решений какой-то проблемы). Скажем, можно
«смягчать»/relax формулирование архитектурных проблем из языка
дискретных решений так, чтобы получать набор вроде бы непрерывных, то
есть дифференцируемых функций, искать архитектурный оптимум на них
нейросетевыми или даже какими-то другими алгоритмами, а потом возвращать
в дискретную область архитектурных решений для формулирования ответа на
вопрос об оптимальной
архитектуре^[<https://ailev.livejournal.com/1464563.html>].
